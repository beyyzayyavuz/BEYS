<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BEYS Home Page</title>

    <!-- CSS -->
    <link
      href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/owl-carousel.css" />
    <link rel="stylesheet" href="assets/css/profile.css" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/font-awesome.css" />

    <link rel="stylesheet" href="assets/css/tooplate-artxibition.css" />
    <link rel="stylesheet" type="text/css" href="assets/css/search.css" />
    <link rel="stylesheet" type="text/css" href="assets/css/ticket.css" />
  </head>

  <body>
    <!-- ***** Preloader Start ***** -->
    <div id="js-preloader" class="js-preloader">
      <div class="preloader-inner">
        <span class="dot"></span>
        <div class="dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
    <!-- ***** Preloader End ***** -->

    <!-- ***** Pre HEader ***** -->
    <div class="pre-header">
      <div class="container">
        <div class="row">
          <div class="col text-end">
            <div class="text-button">
              <a href="contact-us.html">
                Contact Us Now! <i class="fa fa-arrow-right"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ***** Header Area Start ***** -->
    <header class="header-area header-sticky">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <nav class="main-nav">
              <!-- Logo -->
              <a href="index.html" class="logo">BEYS</a>
              <!-- Search Bar -->
              <!-- Modern Search Bar -->
              <form class="modern-search-form" onsubmit="return false;">
                <div class="search-container">
                  <i class="fa fa-search search-icon"></i>
                  <input
                    type="text"
                    id="eventSearchInput"
                    placeholder="Search for matches..."
                  />
                </div>
              </form>

              <!-- Menu -->
              <ul class="nav">
                <li><a href="index.html" class="active">Home</a></li>
                <li><a href="events.html">Events</a></li>
                <li>
                  <a href="login.html" class="custom-login-nav">
                    <span class="nav-login-text">Login</span>
                  </a>
                </li>
              </ul>

              <a class="menu-trigger">
                <span>Menu</span>
              </a>
              <!-- ***** Menu End ***** -->
            </nav>
          </div>
        </div>
      </div>
    </header>
    <!-- ***** Header Area End ***** -->

    <!-- ***** Main Banner Area Start ***** -->
    <div class="main-banner">
      <div class="welcome-text">Welcome to BEYS</div>
    </div>
    <!-- ***** Main Banner Area End ***** -->

    <div class="ticket-container" id="ticket-section">
      <h2>Your Ticket</h2>
      <canvas id="qrCode"></canvas>

      <div class="ticket-details">
        <h2>ðŸŽ« Your Ticket</h2>
        <p><strong>Event:</strong> <span id="ticket-event-title"></span></p>
        <p><strong>Seats:</strong> <span id="ticket-seat-count"></span></p>
        <p>
          <strong>Total Paid:</strong> <span id="ticket-total-price"></span>
        </p>
        <img
          src="assets/images/ticket-qr.png"
          alt="Ticket QR"
          style="width: 200px; margin-top: 20px"
        />
      </div>

      <!-- Sabit QR Image -->
      <img
        src="assets/images/ticket-qr.png"
        alt="QR Icon"
        style="width: 100px; margin-top: 15px"
      />

      <button class="btn-download" id="downloadPDF">
        Download Ticket as PDF
      </button>
    </div>

    <!-- *** Footer *** -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-lg-4">
            <div class="address">
              <h4>BEYS Ticketing Office</h4>
              <span>123 Event Avenue,<br />Istanbul, TÃ¼rkiye<br />Europe</span>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="links">
              <h4>Discover More</h4>
              <ul>
                <li><a href="#">Events</a></li>
                <li><a href="#">Contact Us</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="hours">
              <h4>Open Hours</h4>
              <ul>
                <li>Mon to Fri: 8:00 AM to 6:00 PM</li>
                <li>Sat - Sun: 11:00 AM to 4:00 PM</li>
                <li>Holidays: Closed</li>
              </ul>
            </div>
          </div>

          <div class="col-lg-12">
            <div class="sub-footer">
              <div class="row">
                <div class="col-lg-3">
                  <div class="main-nav">
                    <a href="index.html" class="logo">BEYS</a>
                  </div>
                </div>

                <div class="col-lg-9">
                  <div class="social-links">
                    <ul>
                      <li>
                        <a href="#"><i class="fa fa-twitter"></i></a>
                      </li>
                      <li>
                        <a href="#"><i class="fa fa-facebook"></i></a>
                      </li>
                      <li>
                        <a href="#"><i class="fa fa-behance"></i></a>
                      </li>
                      <li>
                        <a href="#"><i class="fa fa-instagram"></i></a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script src="assets/js/jquery-2.1.0.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/owl-carousel.js"></script>
    <script src="assets/js/scrollreveal.min.js"></script>
    <script src="assets/js/waypoints.min.js"></script>
    <script src="assets/js/jquery.counterup.min.js"></script>
    <script src="assets/js/imgfix.min.js"></script>
    <script src="assets/js/mixitup.js"></script>
    <script src="assets/js/accordions.js"></script>
    <script src="assets/js/custom.js"></script>
    <script src="assets/js/events.js"></script>
    <script src="assets/js/cart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const ticket = JSON.parse(sessionStorage.getItem("selectedEvent"));
        const categoryPrice =
          parseFloat(sessionStorage.getItem("selectedCategoryPrice")) || 0;

        const events = [
          {
            id: "1",
            title: "FenerbahÃ§e Beko vs Anadolu Efes",
            date: "Thursday 20:00 to 22:30",
            location: "Istanbul",
            image: "assets/images/match-01.jpg",
            price: 90,
          },
          {
            id: "2",
            title: "BeÅŸiktaÅŸ Fibabanka vs Galatasaray NEF",
            date: "Sunday 19:00 to 21:00",
            location: "Istanbul",
            image: "assets/images/match-05.jpg",
            price: 120,
          },
          {
            id: "3",
            title: "EczacÄ±baÅŸÄ± Dynavit vs VakÄ±fBank",
            date: "Saturday 17:00 to 19:00",
            location: "Istanbul",
            image: "assets/images/match-02.jpg",
            price: 75,
          },
        ];

        // âœ… Kontrol: Bilet verisi var mÄ±?
        if (!ticket) {
          alert(
            "No ticket data found in session. Please try the purchase again."
          );
          return;
        }

        // âœ… EÅŸleÅŸen etkinliÄŸi bul
        const match = events.find(
          (ev) => ev.title === ticket.title || ev.title === ticket.event
        );
        if (!match) {
          alert("Event details not found.");
          return;
        }

        // âœ… Sayfadaki alanlara verileri yerleÅŸtir
        document.getElementById("ticket-event-title").textContent = match.title;
        document.getElementById("ticket-seat-count").textContent =
          ticket.quantity || 1;

        const totalPaid =
          (ticket.price || match.price) * (ticket.quantity || 1) +
          categoryPrice;
        document.getElementById(
          "ticket-total-price"
        ).textContent = `$${totalPaid}`;

        // âœ… QR Kodu oluÅŸtur
        new QRious({
          element: document.getElementById("qrCode"),
          value: `Event: ${match.title} | Quantity: ${ticket.quantity || 1}`,
          size: 200,
        });

        // âœ… PDF Ä°ndir
        document.getElementById("downloadPDF").addEventListener("click", () => {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          doc.setFontSize(16);
          doc.text("BEYS Ticket", 20, 20);

          doc.setFontSize(12);
          doc.text(`Event: ${match.title}`, 20, 40);
          doc.text(`Date: ${match.date}`, 20, 50);
          doc.text(`Location: ${match.location}`, 20, 60);
          doc.text(`Quantity: ${ticket.quantity || 1}`, 20, 70);
          doc.text(`Price (Each): $${ticket.price || match.price}`, 20, 80);
          doc.text(`Category Fee: $${categoryPrice}`, 20, 90);
          doc.text(`Total Paid: $${totalPaid}`, 20, 100);

          const qrCanvas = document.getElementById("qrCode");
          if (qrCanvas) {
            const qrDataUrl = qrCanvas.toDataURL("image/png");
            doc.addImage(qrDataUrl, "PNG", 140, 40, 50, 50);
          }

          doc.save("BEYS_Ticket.pdf");
        });
      });
    </script>
  </body>
</html>
